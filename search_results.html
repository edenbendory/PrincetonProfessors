{% for prof in professors: %}
<div class="profName w3-container" prof-name={{prof.name}} prof-dept={{prof.department}}>
  <h3 class="w3-opacity"><b>{{prof.name.capitalize()}}</b></h3>
  <p>
    <b>Dept:</b> {{ prof.department.upper() }} â€¢ <b>Rating: </b> {{ prof.rating|round(2)
    }}
  </p>
</div>
<hr />
{% endfor %}


<!-- JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"> </script>
    
<script>

  'use strict'; 

  function handleResponse(data) {
    $('#resultsDiv').html(data);
  }

  function handleError() {
    alert('Error: Failed to fetch data from server');
  }

  let request = null

  function getResults(name, dept) {
    let encodedProfName = encodeURIComponent(name);
    let encodedProfDept = encodeURIComponent(dept);

    let url = '/prof_details?name=' + encodedProfName + "&dept=" + encodedProfDept;

    if (request !== null)
      request.abort();
      
    let requestData = {
      type: 'GET',
      url: url,
      success: handleResponse,
      error: handleError
    };
    $.ajax(requestData);
  }

  function setup() {
    $('.profName').click(function() {
      var name = $(this).attr('prof-name');
      var dept = $(this).attr('prof-dept');
      console.log(name)
      getResults(name, dept)
    });
  }

  $('document').ready(setup);
</script>

</body>
</html>